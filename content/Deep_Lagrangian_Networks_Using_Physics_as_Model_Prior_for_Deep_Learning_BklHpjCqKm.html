<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" class="no-js"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Deep Lagrangian Networks: Using Physics as Model Prior for Deep Learning | OpenReview</title>
  <meta name="description" content="" />

      <meta name="citation_title" content="Deep Lagrangian Networks: Using Physics as Model Prior for Deep Learning" />
        <meta name="citation_author" content="Anonymous" />
      <meta name="citation_publication_date" content="2018/09/27" />
      <meta name="citation_online_date" content="2018/09/27" />
      <meta name="citation_pdf_url" content="https://openreview.net/pdf?id=BklHpjCqKm" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:site" content="@openreviewnet" />
      <meta name="og:title" content="Deep Lagrangian Networks: Using Physics as Model Prior for Deep..." />
      <meta name="og:description" content="Deep learning has achieved astonishing results on many tasks with large amounts of data and generalization within the proximity of training data. For many important real-world applications, these..." />
      <meta name="og:image" content="https://openreview.net/static/images/openreview_logo_512.png" />

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:400,400i,700,700i" />

  <link rel="stylesheet" href="/static/css/bootstrap.min.css" />
  <link rel="stylesheet" href="/static/css/jquery-ui.min.css" />
  <link rel="stylesheet" href="/static/css/main.min.css" />
</head>

<body class="forum">
  <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
  
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand home push-link" href="/"><strong>OpenReview</strong>.net</a>
      </div>
  
      <div id="navbar" class="navbar-collapse collapse">
        <form class="navbar-form navbar-left profile-search" role="search">
          <div class="form-group has-feedback">
            <input id="search_input" type="text" class="form-control ui-autocomplete-input" placeholder="Search ICLR 2019 Conference" autocomplete="off" />
            <span class="glyphicon glyphicon-search form-control-feedback" aria-hidden="true"></span>
          </div>
  
          <input id="search_group" type="hidden" value="ICLR.cc/2019/Conference" />
          <input id="search_content" type="hidden" value="all" />
        <ul id="ui-id-1" tabindex="0" class="ui-menu ui-widget ui-widget-content ui-autocomplete ui-front" style="display: none;"></ul></form>
  
        <ul class="nav navbar-nav navbar-right">
        
            <li id="user-menu"><a href="/login">Login</a></li>
        </ul>
      </div>
  
    </div>
  </nav>

  <div id="or-banner" class="banner" style="">
  <div class="container">
    <div class="row">
      <div class="col-xs-12"><a href="/group?id=ICLR.cc/2019/Conference" title="Venue Homepage"><img class="icon" src="/static/images/arrow_left.svg" /> Go to <strong>ICLR 2019 Conference</strong> homepage</a></div>
    </div>
  </div>
</div>
<div id="flash-message-container" class="alert alert-danger" role="alert" style="display: none;">
  <div class="container">
    <div class="row">
      <div class="col-xs-12">
        <div class="alert-content">
          <button type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <main id="content" class="clearfix openbanner-visible legacy-styles"><div id="note_BklHpjCqKm" class="note panel"><div class="title_pdf_row clearfix"><h2 class="note_content_title"><a>Deep Lagrangian Networks: Using Physics as Model Prior for Deep Learning</a> <a class="note_content_pdf" href="/pdf?id=BklHpjCqKm" title="Download PDF" target="_blank"><img src="/static/images/pdf_icon_blue.svg" /></a> </h2></div><div class="meta_row"><span class="signatures">Anonymous</span></div><div class="clearfix"><div class="meta_row pull-left"><span class="date item">28 Sep 2018 (modified: 19 Nov 2018)</span><span class="item">ICLR 2019 Conference Blind Submission</span><span class="item">Readers: <span class="readers-icon glyphicon glyphicon-globe"></span> Everyone</span><span class="item"><a class="action-bibtex-modal" data-bibtex="@inproceedings{    &#10;anonymous2019deep,    &#10;title={Deep Lagrangian Networks: Using Physics as Model Prior for Deep Learning},    &#10;author={Anonymous},    &#10;booktitle={Submitted to International Conference on Learning Representations},    &#10;year={2019},    &#10;url={https://openreview.net/forum?id=BklHpjCqKm},    &#10;note={under review}    &#10;}">Show Bibtex</a></span><a class="note_content_pdf item" href="/revisions?id=BklHpjCqKm" target="_blank">Show Revisions</a></div><div class="meta_row meta_actions"></div></div><div class="note_contents"><span class="note_content_field">Abstract: </span><span class="note_content_value">Deep learning has achieved astonishing results on many tasks with large amounts of data and generalization within the proximity of training data. For many important real-world applications, these requirements are unfeasible and additional prior knowledge on the task domain is required to overcome the resulting problems. In particular, learning physics models for model-based control requires robust extrapolation from fewer samples – often collected online in real-time – and model errors may lead to drastic damages of the system.
Directly incorporating physical insight has enabled us to obtain a novel deep model learning approach that extrapolates well while requiring fewer samples. As a first example, we propose Deep Lagrangian Networks (DeLaN) as a deep network structure upon which Lagrangian Mechanics have been imposed. DeLaN can learn the equations of motion of a mechanical system (i.e., system dynamics) with a deep network efficiently while ensuring physical plausibility.
The resulting DeLaN network performs very well at robot tracking control. The proposed method did not only outperform previous model learning approaches at learning speed but exhibits substantially improved and more robust extrapolation to novel trajectories and learns online in real-time.</span></div><div class="note_contents"><span class="note_content_field">Keywords: </span><span class="note_content_value">Deep Model Learning, Robot Control</span></div><div class="note_contents"><span class="note_content_field">TL;DR: </span><span class="note_content_value">This paper introduces a physics prior for Deep Learning and applies the resulting network topology for model-based control.</span></div><div class="reply_row clearfix"><div class="item" id="reply_count">7 Replies</div></div></div><hr class="small" /><div id="note_children"><div class="note_with_children"><div id="note_BJlOB02JRm" class="note panel"><div class="title_pdf_row clearfix"><h2 class="note_content_title"><a>further author feedback, or reviewer thoughts after reading the other reviews?</a>  <button class="btn btn-xs btn-default permalink-button" title="Link to this comment" data-permalink-url="https://openreview.net/forum?id=BklHpjCqKm&amp;noteId=BJlOB02JRm"><span class="glyphicon glyphicon-link" aria-hidden="true"></span></button></h2></div><div class="meta_row"><span class="signatures">ICLR 2019 Conference Paper798 Area Chair1</span></div><div class="clearfix"><div class="meta_row pull-left"><span class="date item">19 Nov 2018</span><span class="item">ICLR 2019 Conference Paper798 Official Comment</span><span class="item">Readers: <span class="readers-icon glyphicon glyphicon-globe"></span> Everyone</span></div><div class="meta_row meta_actions"></div></div><div class="note_contents"><span class="note_content_field">Comment: </span><span class="note_content_value">Thank you to the reviewers for the extensive reviews.
Authors:  We welcome a response.
Reviewers:  We do have high variation in the overall paper evaluation, as reflected in the assigned scores.   Do the other reviews change your evaluation of the paper?

-- your area chair</span></div><div class="reply_row clearfix"></div></div><div class="children"></div></div><div class="note_with_children"><div id="note_SJxMlEq-pm" class="note panel"><div class="title_pdf_row clearfix"><h2 class="note_content_title"><a>Interesting paper on using Lagrangian formulation to speed up learning of robot model</a>  <button class="btn btn-xs btn-default permalink-button" title="Link to this comment" data-permalink-url="https://openreview.net/forum?id=BklHpjCqKm&amp;noteId=SJxMlEq-pm"><span class="glyphicon glyphicon-link" aria-hidden="true"></span></button></h2></div><div class="meta_row"><span class="signatures">ICLR 2019 Conference Paper798 AnonReviewer2</span></div><div class="clearfix"><div class="meta_row pull-left"><span class="date item">08 Nov 2018</span><span class="item">ICLR 2019 Conference Paper798 Official Review</span><span class="item">Readers: <span class="readers-icon glyphicon glyphicon-globe"></span> Everyone</span></div><div class="meta_row meta_actions"></div></div><div class="note_contents"><span class="note_content_field">Review: </span><span class="note_content_value">This paper discusses learning of robot dynamics models. They propose to learn the mass-matrix
and the potential forces, which together describe the Lagrangian mechanics of the robot. The unknown
terms are parametrized as a deep neural network, with some properties (such as positive definiteness)
hard-coded in the network structure. The experimental results show the learned inverse model being used
as the feed-forward term for controlling a physical robot. The results show that this approach lead to faster
learning, as long as the model accurately describes the system. The paper is well written and seems free
of technical errors. The contribution is modest, but relevant, and could be a basis for further research. Below
are a few points that could be improved:

1) The paper uses the term partial differential equation in a non-standard way. While Eqs. 4/5 contain partial derivatives,
the unknown function is q, which is a function of time only. Therefore, the Lagrangian mechanics of robot arms are seen
as ordinary differential equations. The current use of the PDE terms should be clarified, or removed.
2) It is not made clear why the potential forces are learned directly, rather than as a derivative of the potential energy. Could you discuss the advantages/disadvantages? 
3) Somewhat related to the previous point: the paper presents learning of dissipative terms as a challenge for future works. Given that the formulation directly allows to add \dot{q} as a variable in g, it seems like a trivial extension. Can you make clearer why this was not done in this paper (yet).
4) The results on the physical robot arm state that the model cannot capture the cable dynamics, due to being a rigid body model. However, the formulation would allow modelling the cables as (non-linear) massless springs, which would probably
explain a large portion of the inaccuracies. I strongly suggest running additional experiments in which the actuator and joints have a separate position, and are connected by springs. If separate measurements of joint-position and actuator position are not available on the arm, it would still be interesting to perform the experiments in simulation, and compare the
performance on hardware with the analytical model that includes such springs.
5) The choice is made to completely hardcode various properties of the mass matrix into the network structure. It would be possible to make some of these properties softcoded. For instance, the convective term C(q,\dot{q})\dot{q} could be learned separately, with the property  C + C^T = \dot{H} encoded as a soft constraint. This would reduce the demand on computing derivatives online.</span></div><div class="note_contents"><span class="note_content_field">Rating: </span><span class="note_content_value">7: Good paper, accept</span></div><div class="note_contents"><span class="note_content_field">Confidence: </span><span class="note_content_value">4: The reviewer is confident but not absolutely certain that the evaluation is correct</span></div><div class="reply_row clearfix"></div></div><div class="children"><div class="note_with_children"><div id="note_S1xsD_SxA7" class="note panel"><div class="title_pdf_row clearfix"><h2 class="note_content_title"><a>Thank you for the extensive review, we have clarified the paper and addressed your questions in the comment</a>  <button class="btn btn-xs btn-default permalink-button" title="Link to this comment" data-permalink-url="https://openreview.net/forum?id=BklHpjCqKm&amp;noteId=S1xsD_SxA7"><span class="glyphicon glyphicon-link" aria-hidden="true"></span></button></h2></div><div class="meta_row"><span class="signatures">ICLR 2019 Conference Paper798 Authors</span></div><div class="clearfix"><div class="meta_row pull-left"><span class="date item">19 Nov 2018</span><span class="item">ICLR 2019 Conference Paper798 Official Comment</span><span class="item">Readers: <span class="readers-icon glyphicon glyphicon-globe"></span> Everyone</span></div><div class="meta_row meta_actions"></div></div><div class="note_contents"><span class="note_content_field">Comment: </span><span class="note_content_value">Thank you for providing such extensive review and raising these important questions. If you have further questions, please feel free to ask.

1) 
Sorry that we have been imprecise on the naming convention. We have updated the paper to make the differences clearer. We replaced Lagrange-Euler PDE with Lagrange-Euler equation and highlight that Eq. 3 can be either a PDE or ODE while Eq. 4 is an ODE. After, Eq. 4 we removed the term PDE. Within the related work section, we use the PDE terminology if the references refer to PDEs. 


2) 
Thank you for bringing up this point as this sparked further discussions and new research questions. Until now we have learned the potential forces g(q) directly as this is standard in robotic applications and for our experiments U(q) is not required. However, if one learns dU/dq and U simultaneously one could extend the cost-function with energy conservation and derive energy-based controllers. 

A quick offline verification on the simulated WAM data showed that learning dU/dq is possible but currently achieves lower performance. Right now, we cannot conclude if this lower performance is due to hyperparameter settings. Therefore, we are running hyperparameter sweeps to compare the differences. 


3) 
Yes, one could just incorporate \dot{q} within g and let g model a mixture of gravity and friction. However, this would contradict Lagrangian Mechanics, where g is the derivative of a E_pot. We would add friction by decomposing \tau into the subparts \tau = \tau_{motor} + \tau_{external} + \tau_{friction}. Simple friction models can be added using the Rayleigh-dissipation function (<a href="https://en.wikipedia.org/wiki/Rayleigh_dissipation_function)." target="_blank" rel="nofollow">https://en.wikipedia.org/wiki/Rayleigh_dissipation_function).</a> However, as described by Albu-Schäfer [1] a "good" friction model for robots is described by \tau_{friction} = f(\q, \qd, \tau). Adding such friction model to Lagrangian mechanics is non-trivial. Especially, due to the torque dependency, the computation of the inverse dynamics is challenging. Therefore, incorporating friction would require answering the questions what a sufficiently good friction model is and require an extensive empirical comparison of multiple friction models, which would beyond the scope of this paper.


4) 
Yes, thank you for bringing this to our attention. We agree that performing such experiments would be interesting. Especially for robots with adaptive stiffness as by Braun et. al. [2]. The Barrett WAM does not provide separate motor (\theta) and joint (q) positions. We are looking into performing such experiments in simulation. Below we discuss the theoretic complexity, practical relevance for the performed experiments and implementation difficulties.    

From a theoretical perspective including this within the learning should not be too difficult. Rather than learning f^{-1}(q, qd, qdd) = \tau one would learn f^{-1}(q, qd, qdd) - K (\theta - q) = 0 where K is a diagonal matrix with positive entries. The structure of DeLan could be easily adapted for this. We will try to also show this in a small experiment.    

From a practical perspective using this model within the controller is more complex. As described in Equation 13.16 in the Springer Handbook of Robotics [3], the inverse model contains d^3 H/d^3t, d^4q/d^4t, d^2g/d^2t, d^2 (d(qd^T H qd)/ dq )/d^2t etc.. Therefore, one would need to compute the higher-order derivatives, which will cause numerical issues that in our opinion would do more harm than help. However, we definitely agree that such model would help when planning using forward model.

From the simulation perspective, we are using PyBullet. To the best of our knowledge, one cannot simulate coupled joints with  Pybullet. Therefore, one has two options. First, simulate the spring outside of PyBullet but this would risk the divergence of the integration of \qdd (PyBullet) and \theta_dd (non-PyBullet). Second one could replace PyBullet with MuJoCo, which can simulate coupled joints but this would require significant implementation effort. Currently, we are evaluating the effort of both.     


5) 
Yes, one could add this soft constraint as penalty term. However, the computational overhead of the derivatives is minimal. The derivative computation (Section 4.2 &amp; 4.3) only requires one clamping operation (for the ReLU non-linearity) and one matrix multiplication per hidden layer. This overhead does not hinder the real-time computations and hence, we prefer to use the hard constraint rather than the soft-constraint.


[1] Alin Albu-Schäffer. Regelung von Robotern mit elastischen Gelenken am Beispiel der DLRLeichtbauarme. PhD thesis, Technische Universität München, 2002.

[2] Braun, D. J., Howard, M., &amp; Vijayakumar, S., 2012). Exploiting variable stiffness in explosive movement tasks. Robotics: Science and Systems VII, 25.

[3] Siciliano, B., &amp; Khatib, O. (Eds.)., 2016. Springer Handbook of Robotics. Springer.</span></div><div class="reply_row clearfix"></div></div><div class="children"></div></div></div></div><div class="note_with_children"><div id="note_H1exdKrp27" class="note panel"><div class="title_pdf_row clearfix"><h2 class="note_content_title"><a>Nice approach, but needs to be situated within the relevant work much better</a>  <button class="btn btn-xs btn-default permalink-button" title="Link to this comment" data-permalink-url="https://openreview.net/forum?id=BklHpjCqKm&amp;noteId=H1exdKrp27"><span class="glyphicon glyphicon-link" aria-hidden="true"></span></button></h2></div><div class="meta_row"><span class="signatures">ICLR 2019 Conference Paper798 AnonReviewer3</span></div><div class="clearfix"><div class="meta_row pull-left"><span class="date item">05 Nov 2018 (modified: 07 Nov 2018)</span><span class="item">ICLR 2019 Conference Paper798 Official Review</span><span class="item">Readers: <span class="readers-icon glyphicon glyphicon-globe"></span> Everyone</span></div><div class="meta_row meta_actions"></div></div><div class="note_contents"><span class="note_content_field">Review: </span><span class="note_content_value">This paper looks at system identification for a multi-link robot based upon combining a neural network with the manipulator equations.  Specifically, the authors propose to model the robot dynamics using the typical manipulator equations, but have a deep neural network parameterize the H(q) and g(q) matrices.  They illustrate that the method can control the systems of a simualted 2-dof robot and real Barrett WAM arm, better than a pure neural network modeling approach, PID control, or an analytic model.

Overall, I think there is a genuinely nice application in this paper, but it's not sufficiently compared to existing approaches nor put in the proper context.  There is a lot of language in the paper about encoding the prior via a PDE, but really what the authors are doing is quite simple: they are doing system identification under the standard robot manipulator equations but using a deep network to model the inertia tensor H(q) and the gravity term g(q).  Learning the parameters that make up H(q) and g(q) is completely standard system identification in robotics, but it's interesting to encode these as a generic deep network (I'm somewhat surprised this hasn't been done before, though a quick search didn't turn up any obvious candidates).  However, given this setting, there are several major issues with the presentation and evaluation, which make the paper unsuitable in its current from.

1) Given the fact that the authors are really just in the domain of system identification and control, there are _many_ approaches that they should compare to.  At the very least, however, the authors should compare to standard system identification techniques (see e.g., Wu et al., "An overview of dynamic parameter identification of robots", 2010, and references therein).  This is especially important on the real robot case, where the authors correctly mention that the WAM arm cannot be expressed exactly by the manipulator equations; this makes it all the more important to try identify system parameters via a data-driven approach, not with the hope of finding the exactly "correct" manipulator equations, but with finding some that are good enough to outperform the "analytical" model that the authors mention.  It's initially non-obvious to me that a generic neural network to model the H and g terms would do any better than some of these standard approaches.

2) A lot of the derivations in the text are frankly unnecessary.  Any standard automatic differentiation toolkit will be able to compute all the necessary derivatives, and for a paper such as this the authors can simply specify the architecture of the system (that they use a Cholesky factorization representation of H, with diagonals required to be strictly positive) and let everything else be handled by TensorFlow, or PyTorch, etc.  The derivations in Sections 4.2 and 4.3 aren't needed.

3) The authors keep referring to the Lagrangian equations as a PDE, and while this is true in general for the actual form here it's just a second order ODE; see e.g. <a href="https://en.wikipedia.org/wiki/Lagrangian_mechanics." target="_blank" rel="nofollow">https://en.wikipedia.org/wiki/Lagrangian_mechanics.</a>  Moreover, these are really just the standard manipulator equations for multi-link systems, and can just be denoted as such.

Despite these drawbacks, I really do like the overall idea of the approach presented here, it's just that the authors would need to _substantially_ revise the presentation and experiments in order to make this a compelling paper.  Specifically, if they simply present the method as a system identification approach for the manipulator equations, with the key terms parameterized by a deep network (and compare to relevant system identification approaches), I think the results here would be interesting, even if they would probably be more interesting to a robotics audience rather than a core ML audience.  But as it is, the paper really doesn't situation this work within the proper context, making it quite difficult to assess its importance or significance.</span></div><div class="note_contents"><span class="note_content_field">Rating: </span><span class="note_content_value">4: Ok but not good enough - rejection</span></div><div class="note_contents"><span class="note_content_field">Confidence: </span><span class="note_content_value">5: The reviewer is absolutely certain that the evaluation is correct and very familiar with the relevant literature</span></div><div class="reply_row clearfix"></div></div><div class="children"><div class="note_with_children"><div id="note_BJgEjeIxR7" class="note panel"><div class="title_pdf_row clearfix"><h2 class="note_content_title"><a>Thank your for the review, but we disagree with some points and hope to clarify these aspects.</a>  <button class="btn btn-xs btn-default permalink-button" title="Link to this comment" data-permalink-url="https://openreview.net/forum?id=BklHpjCqKm&amp;noteId=BJgEjeIxR7"><span class="glyphicon glyphicon-link" aria-hidden="true"></span></button></h2></div><div class="meta_row"><span class="signatures">ICLR 2019 Conference Paper798 Authors</span></div><div class="clearfix"><div class="meta_row pull-left"><span class="date item">19 Nov 2018</span><span class="item">ICLR 2019 Conference Paper798 Official Comment</span><span class="item">Readers: <span class="readers-icon glyphicon glyphicon-globe"></span> Everyone</span></div><div class="meta_row meta_actions"></div></div><div class="note_contents"><span class="note_content_field">Comment: </span><span class="note_content_value">We thank the reviewer for the extensive evaluation. We have updated the paper to precisely differentiate between PDE and ODE and we updated the related work section to explain weaknesses of previous approaches and highlight the differences to existing model learning / system identification (SI) approaches. 

In addition, we want to clarify the brought-up points below. If you have further questions, please feel free to ask. 

1)
SI as described in the textbooks or the survey by Wu et. al. [1] - which is btw. missing key references to state-of-the-art methods such as [2, 3] - is non-trivial and hard for real robots. Our lab has significant experience performing model learning on several robot arms, legged robots and robotic hands. However, using state of the art SI [2,3], we learned dynamics parameters, that did NOT outperform the analytical model of the WAM. Therefore, we only use the analytical model as baseline within the paper. Furthermore, we did evaluate our approach against standard black-box SI methods, as the feed-forward neural network is a standard SI technique, which is also mentioned by Wu. et. al. [1].

In addition, we disagree with your statement, that we did not put our work in the proper context. We related our approach to the extensive research covering model learning. Model learning is much broader than SI, as SI is commonly used to refer to model learning with known basis functions. Therefore, we do not limit our comparison to SI but provide a wider context with model learning. Furthermore, the classic SI described by Atkeson et. al. [4] has many limitations (e.g. not applicable to closed-loop kinematics) and will most likely not infer the actual dynamics parameters. As pointed out by Ting et. al. [2] and Nakanishi et. al. [3], the inferred parameters are not guaranteed to yield a positive definite inertia matrix or satisfy the parallel axis theorem - both aspects are ignored within the proposed survey [1] -. In contrast DeLan is guaranteed to yield a physical plausible model, can be applied to any kinematic structure and does not require any knowledge about kinematics.

I hope we could clarify the problems of standard SI and the consequences for real robot models. Furthermore, we are working to provide empirical data. However, we need to re-implement the features derived by the Newton-Euler formulation as our underlying robotics libraries changed and these features require the computation for all transformations, Jacobians along the complete kinematic chain. If you are aware of a public implementation using URDFs as robot descriptors, please let us know.

2) 
First, we think that reporting the derivatives is good scientific practice and second the analytic computation of the derivatives is necessary for the real-time application. The usage of automatic differentiation in PyTorch does not allow the computation of the feedforward torque with 200Hz. As pointed out in these discussions (<a href="https://discuss.pytorch.org/t/how-to-compute-jacobian-matrix-in-pytorch/14968/7," target="_blank" rel="nofollow">https://discuss.pytorch.org/t/how-to-compute-jacobian-matrix-in-pytorch/14968/7,</a> https://stackoverflow.com/questions/43451125/pytorch-what-are-the-gradient-arguments/47026836) the computation of the partial derivatives w.r.t. to network input does not scale well to high-dimensions. If you would prefer to have these derivations within the Appendix, we can also put the derivations within the Appendix.

3) 
Sorry for being imprecise with the PDE notation. We have updated the paper to be more precise when the equations are referring to a PDE or an ODE. 

We also want to point out that Eq. 4 is NOT "just the standard manipulator equations", Eq. 4 applies to any non-relativistic multi-particle system, which can be described with holonomic constraints. Therefore, the Lagrangian Mechanics formalism is applicable for closed-loop kinematic chains, where the standard Newton-Euler approaches fail. Furthermore, most literature related to manipulator equations ignores the functional dependency between C and H, while DeLan explicitly models this functional dependency. We have updated the description to clarify the differences.

[1]Wu, J., Wang, J. and You, Z., 2010. An overview of dynamic parameter identification of robots. Robotics and computer-integrated manufacturing, 26(5), pp.414-419.

[2] Ting, J. A., Mistry, M., Peters, J., Schaal, S., &amp; Nakanishi, J., 2006. A Bayesian Approach to Nonlinear Parameter Identification for Rigid Body Dynamics. In Robotics: Science and Systems, pp. 32-39.

[3] Nakanishi, J., Cory, R., Mistry, M., Peters, J. and Schaal, S., 2008. Operational space control: A theoretical and empirical comparison. The International Journal of Robotics Research, 27(6), pp.737-757.

[4] Atkeson, C. G., An, C. H., &amp; Hollerbach, J. M., 1986. Estimation of inertial parameters of manipulator loads and links. The International Journal of Robotics Research, 5(3), 101-119.</span></div><div class="reply_row clearfix"></div></div><div class="children"></div></div></div></div><div class="note_with_children"><div id="note_S1xd1wOo2X" class="note panel"><div class="title_pdf_row clearfix"><h2 class="note_content_title"><a>Promising, simple approach to model learning. Some questions regarding generalizability to systems with complex dynamics.</a>  <button class="btn btn-xs btn-default permalink-button" title="Link to this comment" data-permalink-url="https://openreview.net/forum?id=BklHpjCqKm&amp;noteId=S1xd1wOo2X"><span class="glyphicon glyphicon-link" aria-hidden="true"></span></button></h2></div><div class="meta_row"><span class="signatures">ICLR 2019 Conference Paper798 AnonReviewer1</span></div><div class="clearfix"><div class="meta_row pull-left"><span class="date item">04 Nov 2018 (modified: 07 Nov 2018)</span><span class="item">ICLR 2019 Conference Paper798 Official Review</span><span class="item">Readers: <span class="readers-icon glyphicon glyphicon-globe"></span> Everyone</span></div><div class="meta_row meta_actions"></div></div><div class="note_contents"><span class="note_content_field">Review: </span><span class="note_content_value">I like the simplicity of the approach in this paper (especially compared to very computationally hungry methods such as Deepmind's "Graph Networks as Learnable Physics Engines for Inference and Control"). The fact that the approach allows for online learning is also interesting. I very much appreciate that you tested your approach on a real robot arm!

I have a number of questions, which I believe could help strengthen this paper:
- The decomposition of H into L^TL ensures H is positive definite, however there are no constraints on g (gravity/external forces). How do you ensure the model doesn't degenerate into only using g and ignoring H? In the current formulation g only depends on q, however this seems insufficient to model velocity dependent external forces (e.g. contact dynamics). Please elaborate.
- How would you handle partial observability of states? Have you tried this? 
- How would you extend this approach to soft robots or robots for which the dimensionality of the state space is unknown?
- Have you tested your method on systems that are not kinematic chains? How would complex contact dynamics be handled (e.g. legged robots)?
- It would be interesting to see more comparisons with recent work (e.g. Deepmind's).

Some figures (e.g. Figure 6) are missing units on the axes. Please fix.</span></div><div class="note_contents"><span class="note_content_field">Rating: </span><span class="note_content_value">7: Good paper, accept</span></div><div class="note_contents"><span class="note_content_field">Confidence: </span><span class="note_content_value">3: The reviewer is fairly confident that the evaluation is correct</span></div><div class="reply_row clearfix"></div></div><div class="children"><div class="note_with_children"><div id="note_SJe1dTrlCm" class="note panel"><div class="title_pdf_row clearfix"><h2 class="note_content_title"><a>Thank you for the review and the comments regarding the kinematic structure.</a>  <button class="btn btn-xs btn-default permalink-button" title="Link to this comment" data-permalink-url="https://openreview.net/forum?id=BklHpjCqKm&amp;noteId=SJe1dTrlCm"><span class="glyphicon glyphicon-link" aria-hidden="true"></span></button></h2></div><div class="meta_row"><span class="signatures">ICLR 2019 Conference Paper798 Authors</span></div><div class="clearfix"><div class="meta_row pull-left"><span class="date item">19 Nov 2018</span><span class="item">ICLR 2019 Conference Paper798 Official Comment</span><span class="item">Readers: <span class="readers-icon glyphicon glyphicon-globe"></span> Everyone</span></div><div class="meta_row meta_actions"></div></div><div class="note_contents"><span class="note_content_field">Comment: </span><span class="note_content_value">Thank you for your extensive review. Your question regarding closed-loop kinematics chains sparked interesting discussions yielding additional advantages of the approach. We have fixed the issues you mentioned in the figures.

1)  
Yes, there are no constraints on the decomposition of the torque. This decomposition is unsupervised and could yield degenerate solutions. From our experience, degenerate solutions are learned if one of the components - either H or g - dominates during initialisation. Tuning the hyperparameters for the initialization, i.e., the variance of the gaussian distribution initializing the weights, one achieves a good decomposition into g and H.  

To incorporate external forces, one has two options. First, conservative forces, e.g., joints coupled by springs, can be added to V, i.e., V = V_g + V_p. If the external forces are non-conservative, e.g., contact forces, one must decompose \tau. Commonly \tau is decomposed into \tau = \tau_{friction} + \tau_{actuator} + \tau_{external}. The external forces must be projected to the generalized coordinates using \tau_{external} = J_p^{T} f, where f are the external forces acting on point p and J_p the jacobian. 


2) 
This depends on the exact definition of partial observability (PO):

- If one interprets PO as observing the state with noise and no direct sensing of the accelerations, DeLan can learn the dynamics using noisy observations and approximated accelerations using finite differences. 

- If one interprets PO as missing sensor measurements of a single generalized coordinate, DeLan will not be able of the learning the dynamics. Furthermore, such partial observability would violate the underlying assumption of Lagrangian Mechanics as the system input does not represent generalized coordinates. 

- If one interprets PO as an over constrained observation, i.e. a high-dimensional signal that encodes the low-dimensional state, one could learn a latent space embedding, whereas dynamics in the latent space are described by Lagrangian mechanics.    


3) 
As the Euler-Lagrange equation (Eq. 3) applies to vibrations and soft robotics, where the state dimensionality is not finite. One could apply an extension of the current approach to soft robotics. We represent the kinetic energy as T = 1/2 \dot{q} H(q) \dot{q}, which applies to system with finite particles. For soft robotics, one would need to represent the kinetic energy as continuous function. Therefore, the Lagrange Euler equation would not simplify to an ODE and one would need to incorporate the PDE. We are currently exploring this direction and don't see any structural problems.    


4)
Thank you for bringing up the different kinematic structures. The problems of closed-loop kinematics are mainly due to use of the Newton-Euler formalism. In contrast, the Lagrangian Mechanics formalism applies to any non-relativistic multi-particle system with holonomic constraints. As closed-loop kinematics only require holonomic constraints, learning the dynamics of closed-loop kinematics can be achieved with DeLan. Older works [1, 2, 3] used Lagrangian Mechanics to manually derive the dynamics of closed-loop kinematics. 

Currently, we are looking for publicly available model files of parallel robots (*.sdf or *.urdf) and try to include the evaluations. Up to now, we were not able to find such robot description. If you are aware of such models, we would appreciate your help.  

Regarding the contact dynamics. If one can observe the contact force and the point of contact, one can include the contact forces within the learning (see point (1)). If neither is known the learning would be too ambiguous. However, if one has learned the contact-free dynamics, one can compute the external forces on the end-effector and perform force-control without additional sensors. Using system identification this sensorless force control has been done by Wahrburg et. al. [4].   


5) 
Yes, we are definitely planning on exploring this approach in future work. We want to use the forward model for planning and compare the performance to black-box model learning. When using the forward model, we will compare to the recent work from Deepmind and other authors. 


[1] Miller, K., 1992. The Lagrange-based model of Delta-4 robot dynamics. Robotersysteme, 8, pp.49-54.

[2] Liu, K., Lewis, F., Lebret, G., &amp; Taylor, D., 1993. The singularities and dynamics of a Stewart platform manipulator. Journal of Intelligent and Robotic Systems, 8(3), pp.287-308.

[3] Geng, Z., Haynes, L.S., Lee, J.D. and Carroll, R.L., 1992. On the dynamic model and kinematic analysis of a class of Stewart platforms. Robotics and autonomous systems, 9(4), pp.237-254.
 
[4] Wahrburg, A., Bös, J., Listmann, K. D., Dai, F., Matthias, B., &amp; Ding, H., 2018. Motor-Current-Based estimation of cartesian contact forces and torques for robotic manipulators and its application to force control. IEEE Transactions on Automation Science and Engineering, 15(2), pp.879-886.</span></div><div class="reply_row clearfix"></div></div><div class="children"></div></div></div></div></div></main></div>
  </div>
</div>


    <!-- Footer -->
    <footer class="sitemap">
      <div class="container">
        <div class="row hidden-xs">
          <div class="col-sm-4">
            <ul class="list-unstyled">
              <li><a href="/" class="home">Home</a></li>
              <li><a href="/venues">All Venues</a></li>
            </ul>
          </div>
    
          <div class="col-sm-4">
            <ul class="list-unstyled">
              <li><a href="/about">About OpenReview</a></li>
              <li><a href="/contact">Contact</a></li>
              <li><a href="#" data-toggle="modal" data-target="#feedback-modal">Feedback</a></li>
            </ul>
          </div>
    
          <div class="col-sm-4">
            <ul class="list-unstyled">
              <li><a href="/terms">Terms of Service</a></li>
              <li><a href="/privacy">Privacy Policy</a></li>
            </ul>
          </div>
        </div>
    
        <div class="row visible-xs-block">
          <div class="col-xs-6">
            <ul class="list-unstyled">
              <li><a href="/" class="home">Home</a></li>
              <li><a href="/about">About OpenReview</a></li>
              <li><a href="#" data-toggle="modal" data-target="#feedback-modal">Feedback</a></li>
            </ul>
          </div>
    
          <div class="col-xs-6">
            <ul class="list-unstyled">
              <li><a href="/contact">Contact</a></li>
              <li><a href="/terms">Terms of Service</a></li>
              <li><a href="/privacy">Privacy Policy</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    
    <footer class="sponsor">
      <div class="container">
        <div class="row">
          <div class="col-sm-10 col-sm-offset-1">
            <p class="text-center">
              OpenReview is created by the <a href="http://www.iesl.cs.umass.edu/" target="_blank">Information Extraction and Synthesis Laboratory</a>, College of Information and Computer Science, University of Massachusetts Amherst. We gratefully acknowledge the support of the OpenReview sponsors:  Google,  Facebook, NSF, the University of Massachusetts Amherst Center for Data Science, and Center for Intelligent Information Retrieval, as well as the Google Cloud Platform for donating the computing and networking services on which OpenReview.net runs.
            </p>
          </div>
        </div>
      </div>
    </footer>

  <div id="feedback-modal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
          <h3 class="modal-title">Send Feedback</h3>
        </div>
        <div class="modal-body">
          <p>Enter your feedback below and we'll get back to you as soon as possible.</p>
          <form action="/feedback" method="POST">
            <div class="form-group">
              <input type="email" name="from" class="form-control" placeholder="Email" />
            </div>
            <div class="form-group">
              <input type="text" name="subject" class="form-control" placeholder="Subject" />
            </div>
            <div class="form-group">
              <textarea name="message" class="form-control feedback-input" rows="5" placeholder="Message" required=""></textarea>
            </div>
          <ul id="ui-id-2" tabindex="0" class="ui-menu ui-widget ui-widget-content" style="display: none;"></ul></form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">Send</button>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
  <script>window.jQuery || document.write('&lt;script src="/static/js/vendor/jquery-2.2.4.min.js"&gt;&lt;\/script&gt;')</script>

  <script src="/static/dist/vendor.min.js"></script>
  <script src="/static/dist/templates.min.js"></script>
  <script src="/static/dist/openreview.min.js"></script>

    <script>window.legacyScripts = true;</script>


    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-108703919-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());
      gtag('config', 'UA-108703919-1');
    </script>


<div role="status" aria-live="assertive" aria-relevant="additions" class="ui-helper-hidden-accessible"></div></body></html>